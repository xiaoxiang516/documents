<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
  <title>JavaScript获取客户端IP</title>
</head>

<body>
  <script>
    function GetLocalIPAddress() {
      var obj = null;
      var rslt = "";
      try {
        obj = new ActiveXObject("rcbdyctl.Setting");
        rslt = obj.GetIPAddress;
        obj = null;
      } catch (e) {}
      return rslt;
    }
    document.write("你的IP是：" + GetLocalIPAddress());
  </script>
</body>

</html>
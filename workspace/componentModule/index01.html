<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<a href="">发送到桌面</a>
		<button id="" onclick="CreateShortcut()">
			发送到桌面
		</button>
		<script>
		function CreateShortcut() { 
			console.log(999999999);
		    try{ 
		        varfso = newActiveXObject("Scripting.FileSystemObject"); 
		        varshell = newActiveXObject("WScript.Shell"); 
		        vartagFolder = shell.SpecialFolders("Desktop"); 
		        if(!fso.FolderExists(tagFolder )) { 
		            fso.CreateFolder(tagFolder); 
		        } 
		        if(!fso.FileExists(tagFolder + "\\乐猪软件.lnk")) { 
		            varWshSysEnv = shell.Environment("Process"); 
		            iLocal = (WshSysEnv.Item("SystemRoot") +"\\1.ico"); //下载到C:\windows\1.ico 
		            iRemote = ("/Images/2.ico"); //先下载图标文件，再用自定义图标把首页的图标地址替换 
		            varxPost = newActiveXObject("Microsoft.XMLHTTP"); 
		            xPost.Open("GET", iRemote, 0); 
		            xPost.Send(); 
		            varsGet = newActiveXObject("ADODB.Stream"); 
		            sGet.Mode = 3; 
		            sGet.Type = 1; 
		            sGet.Open(); 
		            sGet.Write(xPost.ResponseBody ); 
		            sGet.SaveToFile( iLocal,2); 
		            varlink = shell.CreateShortcut(tagFolder + "\\编程入门管理系统.lnk"); 
		            link.Description = "打开基本软件的快捷方式"; 
		            link.Hotkey = "Ctrl+Alt+e"; 
		            link.TargetPath = "http://www.lezhu99.com/"; 
		            link.IconLocation=iLocal; 
		            link.WindowStyle = 3; 
		            link.WorkingDirectory = "c:\\blah"; 
		            link.Save(); 
		            alert("恭喜！快捷方式创建成功！"); 
		        } 
		    } 
		    catch(ex){ 
		        alert("快捷方式创建失败，可能浏览器不支持！"); 
		    } 
		}
			 
			
		pageIndex: null,
		pagesize: null,
		keyword: null,
		

		</script>
	</body>
</html>
